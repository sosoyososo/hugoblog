---
title: '再看一次SDWebImage缓存'
date: Thu, 14 Sep 2017 03:29:03 +0000
draft: false
tags: ['iOS', 'Objective-C']
---

再次理了一下SDWebImage的结构，做个记录：

1.  基本的图片加载功能，满足最最基本的需求(额外支持webp，gif，并且自动识别图片格式，识别图片方向)
2.  对各种展示图片相关的控件的扩展，满足大部分场景的使用
3.  通过SDWebImageOptions提供各种细节控制，满足一些常见的特殊需求
4.  Manager 为下载提供后台支持的总入口，封装下载缓存，并提供option作为对下载和缓存行为操作。
5.  后台的图片解压功能，加速你的图片展示，降低主线程的压力。
6.  Downloader 是下载真正发生的地方，配置、保存、查看所有活动的任务，集成缓存操作，自动查询缓存，自动缓存下载内容。
7.  Cache提供内存和硬盘两级缓存，可以同时作用或者选择一个，可以很简单的配置缓存大小。内存警告自动清空内存缓存，进入后台或者终止程序，清除硬盘上过期图片，如果超出存储大小，图片按照修改时间顺序清除。内存缓存利用系统的NSCache，使用基于像素的计数机制，加上了内存清理通知监听，没有失效机制。文件缓存直接写文件，可以设置存储文件总大小作为限制，有基于时间的失效机制。
8.  另外提供了预加载器