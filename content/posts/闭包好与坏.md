---
title: '闭包好与坏'
date: Thu, 03 Nov 2016 03:29:30 +0000
draft: false
tags: ['Objective-C', 'Program Language']
---

现代化的编程语言中，大都包含闭包，iOS开发主要涉及到的Objective-C和Swift也都支持，我早期接触Objectice-C后开始大规模的使用Block，然后切换到Swift之后，也使用闭包继承过来。在最近的一个项目中，因为工期原因，我先写UI交互部分，然后发现仅仅这部分代码看起来就很臃肿。然后分析原因的时候赫然发现是因为对闭包的过度使用造成的。 那么在软件开发中，是否还应该使用闭包，如果应该使用闭包，那么如何把握使用的度？要回答这个问题，我首先想先理一下闭包的好处和坏处。

好的或者方便的
-------

写代码很顺滑，特别是结合了RxSwift或者ReactCocoa这类支持Block的响应式三方库之后，再加上自己的扩展和抽象的控件，真是简直了，有时候看起来还比较复杂的业务，直接一个函数就能搞定。每每碰到这种情况就欲罢不能 ～

不好或者繁琐的
-------

看代码真的很累，不得不专门针对这个情况在代码布局上作出调整，否则全都一团乱麻；IDE本来支持的函数条转大大弱化，这让需要找某个功能的时候很心累；另外代码调试也是个大问题，一旦报错，一层层的闭包下去，比较难以定位；另外，内存也是问题，过度使用难免会碰到循环引用导致内存无法释放，还有就是多层嵌套调用的闭包，在保存现场上就会耗费大量的内存。

要不要用
----

上面的描述虽然只是我的个人之见，但坏处看似要比好处多很多，那当时为啥还要使用？爽呗 ～ 以至于根本没有细心想是否值得的问题。那么坏处这么多是不是就不应该使用了呢？当然不，这么爽的东西不用怎么能行？那么就需要掌握个度。

怎么用
---

结合上面的描述，我们需要避免的是过度使用，而非不用。这个度应该怎么把握？我觉得总的逻辑是闭包层次不能过深。坏处里面提到的很多问题都是因为过度使用导致的过度复杂引起的，我们如果降低复杂度，很多问题都可以避免。另外，明显独立的功能就抽出来单独写个函数，对阅读代码和降低复杂度都有用。